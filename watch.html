<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>مشاهدة</title>
  <style>
    body { margin:0; font-family:Arial, sans-serif; background:#f9f9f9; }
    header { background:#fff; padding:8px 16px; border-bottom:1px solid #ddd; position:sticky; top:0; }
    header .logo { color:#ff0000; font-weight:bold; font-size:20px; cursor:pointer; }
    .container { display:flex; padding:20px; gap:20px; }
    .main { flex:3; }
    iframe, video { width:100%; height:480px; background:#000; }
    h2 { margin:10px 0; font-size:20px; }
    p { color:#555; }
    .sidebar { flex:1; max-height:calc(100vh - 60px); overflow:auto; }
    .side-card { display:flex; margin-bottom:10px; cursor:pointer; }
    .side-card img { width:120px; height:70px; object-fit:cover; margin-left:8px; }
    .side-card div { font-size:13px; }
  </style>
</head>
<body>
  <header>
    <div class="logo" onclick="window.location.href='index.html'">▶ MyTube</div>
  </header>

  <div class="container">
    <div class="main">
      <div id="playerContainer"></div>
      <h2 id="videoTitle"></h2>
      <p id="videoDesc"></p>
    </div>
    <div class="sidebar" id="sidebar"></div>
  </div>

<script>
let videos = [];
const params = new URLSearchParams(window.location.search);
const vidId = params.get("id");

// تحميل الفيديوهات
fetch('videos.json')
  .then(res=>res.json())
  .then(data=>{
    videos = data.items || [];
    showVideo();
    renderSidebar();
  });

function showVideo(){
  const v = videos.find(x=>x.id===vidId);
  if(!v) return;
  document.getElementById('videoTitle').textContent = v.title;
  document.getElementById('videoDesc').textContent = v.description;
  const container = document.getElementById('playerContainer');
  container.innerHTML = '';

  if(v.videoUrl.includes("drive.google.com") && v.videoUrl.includes("/preview")){
    const iframe = document.createElement('iframe');
    iframe.src = v.videoUrl;
    iframe.frameBorder = "0";
    iframe.allow = "autoplay";
    iframe.width = "100%";
    iframe.height = "480";
    container.appendChild(iframe);
  } else {
    const video = document.createElement('video');
    video.controls = true;
    video.src = v.videoUrl;
    video.poster = v.thumbnailUrl || '';
    container.appendChild(video);
    video.play().catch(()=>{});
  }
}

function renderSidebar(){
  const sidebar = document.getElementById('sidebar');
  videos.forEach(v=>{
    if(v.id===vidId) return;
    const item = document.createElement('div');
    item.className = 'side-card';
    item.innerHTML = `
      <img src="${v.thumbnailUrl}" alt="">
      <div>${v.title}</div>
    `;
    item.onclick = ()=>{ window.location.href="watch.html?id="+v.id; };
    sidebar.appendChild(item);
  });
}
</script>
</body>
</html>
